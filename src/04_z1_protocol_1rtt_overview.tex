\begin{figure*}[htb]
\begin{center}

1-RTT connection establishment \vspace{10pt}\\

\fbox{
\begin{minipage}[t]{0.39\textwidth}
\begin{tabular}[c]{l}
 $\quad Client$ \\
 $ $ \\
 \setcounter{nombre}{0}%
 $\prob.\quad \cid \xleftarrow{\$} \{0,1\}^{64} $ \\
 $\prob.\quad m_1 = \cid$ \\
 $ $\\
 \setcounter{nombre}{0}%
 $\prob.\quad (\SCID, T_s, \sigma_s) = \SCFG_{pub}$ \\
 $\prob.\quad \doc = \SCID \| T_s$ \\
 $\prob.\quad \text{If } \SIG.\Vfy(pk_s, \sigma_s, \doc)$ \\
 $\prob.\quad \quad \Lambda = \text{'reject' and abort}$ \\
 $\prob.\quad t_c \xleftarrow{\$} \Zset_{q}^{\ast} $ \\
 $\prob.\quad T_c = g^{t_c} $ \\
 $\prob.\quad \NONC \xleftarrow{\$} \{0,1\}^{160} $ \\
 $\prob.\quad m_3 = (T_c, \NONC, \STK, \SCID, \cid)$ \\
 $\prob.\quad pms = T_s^{t_c}$ \\
 $\prob.\quad ms = \PRF(pms, NONC)$ \\
 $\prob.\quad \ik = \PRF(ms, m_1 \| m_2 \| m_3)$ \\
 $\prob.\quad \Lambda = \preaccept$ \\
\end{tabular}
\end{minipage}%
}
% middle
 \begin{minipage}[t]{0.13\textwidth}
  \centering
  \begin{tabular}{c}
   $ $ \\
   $ $ \\
   $ $ \\
   $\xrightarrow{m_1}$ \\
   $ $ \\
   $\xleftarrow{m_2}$ \\
   $ $ \\
   $ $ \\
   $ $ \\
   $ $ \\
   $ $ \\
   $ $ \\
   $\xrightarrow{m_3}$ \\
   $ $ \\
  \end{tabular}
 \end{minipage}%
\fbox{
\begin{minipage}[t]{0.39\textwidth}
\begin{tabular}[c]{l}
 $\quad Server$ \\
 $ $ \\
 $ $ \\
 $ $ \\
 \setcounter{nombre}{0}%
 $\prob.\quad \text{choose } \SCFG = (\SCFG_{pub}, t_s) $\\
 $\prob.\quad (\SCID, T_s, \sigma_s) = \SCFG_{pub}$ \\
 $\prob.\quad \makeSTKQUIC$ \\
 $\prob.\quad m_2 = (\SCFG_{pub}, \STK, \cid)$ \\
 $ $ \\
 $ $ \\
 $ $ \\
 $ $ \\
 $ $ \\
 \setcounter{nombre}{0}%
 $\prob.\quad \text{search $\SCFG$ with $\SCID$}$ \\
 $\prob.\quad pms = T_c^{t_s}$ \\
 $\prob.\quad ms = \PRF(pms, \NONC)$ \\
 $\prob.\quad \ik = \PRF(ms, m_1 \| m_2 \| m_3)$ \\
 $\prob.\quad \Lambda = \preaccept$ \\
\end{tabular}
\end{minipage}%
} \vspace{10pt}

1-RTT connection establishment for forward secure key
\vspace{10pt}\\

\ONERTTtrue
\ORIGINALtrue
\input{04_z3_forward_secure_key}

\caption{Abstract model of 1-RTT QUIC handshake}\label{fig:quic_abst_1rtt}
\end{center}
\end{figure*}