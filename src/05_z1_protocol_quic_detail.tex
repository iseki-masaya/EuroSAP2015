\begin{figure*}[!htb]
\begin{center}

Fullhandshake between a client and a server \vspace{10pt}\\

\fbox{
\begin{minipage}[t]{0.35\textwidth}
\begin{tabular}[t]{l}
 $\quad Client$ \\
 $$ \\
 $1.\ \ \NONC \leftarrow \$$ \\
 $2.\ \ t_c \xleftarrow{\$} \mathbb{Z}_q$ \\
 $3.\ \ T_c=g^{t_c}$ \\
 $4.\ \ m_1 = (T_c, \NONC)$ \\
 $$\\
 $1.\ \ \peer = S, \text{$S$ is determined from $cert_s$}$ \\
 $2.\ \ pk_s = \getPK(cert_s)$ \\
 $3.\ \ pms = T_s^{t_c}$ \\
 $4.\ \ ms = \PRF(pms, \NONC)$ \\
 $5.\ \ trans = T_s \| T_c \| \SCID \| \NONC$ \\
 $6.\ \ k = \PRF(ms, trans)$ \\
 $7.\ \ \Lambda=\preaccept$ \\
 $8.\ \ T_s^{\ast} = \SE.\Dec(k,c_s,H,st_d)$ \\
 $9.\ \ \text{If } \SIG.\Vfy(pk_s, \sigma_s, trans \| T_s^{\ast}) = \perp$ \\
 $10.\  \quad \Lambda = \text{'reject' and abort}$ \\
 $11.\  pms^{\ast} = T_s^{\ast t_c}$ \\
 $12.\  ms^{\ast} = \PRF(pms^{\ast}, NONC)$ \\
 $13.\  trans^{\ast} = T_s^{\ast} \| T_c \| \SCID \| \NONC$ \\
 $14.\  k=\PRF(ms^{\ast}, trans^{\ast})$ \\
 $15.\  \Lambda=\accept$ \\
 $16.\  \theta \leftarrow (\SCID, T_s^{\ast})$ \\
\end{tabular}
\end{minipage}%
}
\begin{minipage}[t]{0.13\textwidth}
\begin{tabular}[t]{l}
 $$\\
 $$\\
 $$\\
 $$\\
 $\xrightarrow{\hspace{5pt}\text{CHLO}(m_1)\hspace{5pt}}$\\
 $$\\
 $$\\
 $$\\
 $\xleftarrow{\hspace{5pt}\text{SHLO}(m_2)\hspace{5pt}}$\\
 $$\\
 $$\\
 $$\\
 $$\\
\end{tabular}
\end{minipage}%
\fbox{
\begin{minipage}[t]{0.35\textwidth}
\begin{tabular}[t]{l}
 $\quad Server$ \\
 $$\\
 $1.\ \ \SCID \leftarrow \{0,1\}^{\lambda} $ \\
 $2.\ \ \peer = \SCID$ \\
 $3.\ \ t_s \xleftarrow{\$} \mathbb{Z}_q$ \\
 $4.\ \ T_s = g^{t_s}$ \\
 $5.\ \ trans= T_s \| T_c \| \SCID \| \NONC$ \\
 $6.\ \ pms=T_c^{t_s}$ \\
 $7.\ \ ms=\PRF(pms, \NONC)$ \\
 $8.\ \ k=\PRF(ms, trans)$ \\
 $9.\ \ \Lambda=\preaccept$ \\
 $10.\  t_s^{\ast} \xleftarrow{\$} \mathbb{Z}_q$ \\
 $11.\  T_s^{\ast} = g^{t_s^{\ast}}$ \\
 $12.\  c_s = \SE.\Enc(k,len,H,T_s^{\ast},st_e)$ \\
 $13.\  \sigma_s = \SIG.\Sign(sk_s,trans \| T_s^{\ast})$ \\
 $14.\  m_2 = (T_s, \sigma_s, \SCID, cert_s, c_s)$ \\
 $15.\  pms^{\ast} = T_c^{t_s^{\ast}}$ \\
 $16.\  ms^{\ast} = \PRF(pms^{\ast}, \NONC)$ \\
 $17.\  trans^{\ast} = T_s^{\ast} \| T_c \| \SCID \| \NONC$ \\
 $18.\  k=\PRF(ms^{\ast}, trans^{\ast})$ \\
 $19.\  \Lambda=\accept$ \\
 $20.\  \theta(\SCID) \leftarrow (T_s^{\ast},t_s^{\ast})$ \\
 $$
\end{tabular}
\end{minipage}%
} \vspace{10pt}

Resumption between a client and a server \vspace{10pt}\\

\fbox{
\begin{minipage}[t]{0.35\textwidth}
\begin{tabular}[t]{l}
 $1.\ \ (\SCID,T_s^{\ast}) \leftarrow \theta$ \\
 $2.\ \ t_c^{\prime} \xleftarrow{\$} \mathbb{Z}_q$ \\
 $3.\ \ T_c^{\prime}=g^{t_c^{\prime}}$ \\
 $4.\ \ pms^{\prime} = T_s^{\ast t_c^{\prime}}$ \\
 $5.\ \ \NONC^{\prime} \leftarrow \$$ \\
 $6.\ \ ms^{\prime} = \PRF(pms^{\prime}, \NONC^{\prime})$ \\
 $7.\ \ trans^{\prime} = T_s^{\ast} \| T_c^{\prime} \| \SCID \| \NONC^{\prime}$ \\
 $8.\ \ fin_c = \PRF(ms^{\prime}, trans^{\prime})$ \\
 $9.\ \ k=\PRF(ms^{\prime}, trans^{\prime})$ \\
 $10.\  \Lambda=\preaccept$ \\
 $11.\  m_1^{\prime} = (T_c^{\prime},\SCID,\NONC^{\prime},fin_c)$ \\
 $$\\
 $1.\ \ \text{If } \SE.\Dec(k,c_s,H,st_d) = \perp$ \\
 $2.\ \ \quad \Lambda=\text{'reject' and abort}$ \\
 $3.\ \ T_s^{\ast} = \SE.\Dec(k,c_s,H,st_d)$ \\
 $4.\ \ pms^{\ast} = T_s^{\ast t_c^{\prime}}$ \\
 $5.\ \ ms^{\ast} = \PRF(pms^{\prime}, \NONC^{\prime})$ \\
 $6.\ \ trans^{\ast} = T_s^{\ast} \| T_c^{\prime} \| \SCID \| \NONC^{\prime}$ \\
 $7.\ \ k=\PRF(ms^{\ast}, trans^{\ast})$ \\
 $8.\ \ \Lambda=\accept$ \\
 $9.\ \ \theta \leftarrow (\SCID,T_s^{\ast},fin_c)$ \\
\end{tabular}
\end{minipage}%
}
\begin{minipage}[t]{0.13\textwidth}
\begin{tabular}[t]{l}
 $$\\
 $$\\
 $$\\
 $$\\
 $$\\
 $$\\
 $\xrightarrow{\hspace{5pt}\text{CHLO}(m_1^{\prime})\hspace{5pt}}$\\
 $$\\
 $$\\
 $$\\
 $$\\
 $$\\
 $\xleftarrow{\hspace{5pt}\text{SHLO}(m_2^{\prime})\hspace{5pt}}$\\
\end{tabular}
\end{minipage}%
\fbox{
\begin{minipage}[t]{0.35\textwidth}
\begin{tabular}[t]{l}
 $$\\
 $1.\ \ (T_s^{\ast}, t_s^{\ast}) \leftarrow \theta(\SCID)$ \\
 $2.\ \ pms^{\prime}=T_c^{\prime t_s^{\ast}}$ \\
 $3.\ \ ms^{\prime}=\PRF(pms^{\prime}, \NONC^{\prime})$ \\
 $4.\ \ trans^{\prime}= T_s^{\ast} \| T_c^{\prime} \| \SCID \| \NONC^{\prime}$ \\
 $5.\ \ fin_c^{\ast} = \PRF(ms^{\prime}, trans^{\prime})$ \\
 $6.\ \ \text{If } fin_c^{\ast} \neq fin_c$ \\
 $7.\ \ \quad \Lambda=\text{'reject' and abort}$ \\
 $8.\ \ k=\PRF(ms^{\prime}, trans^{\prime})$ \\
 $9.\ \ \Lambda=\preaccept$ \\
 $10.\  t_s^{\ast} \xleftarrow{\$} \mathbb{Z}_q $ \\
 $11.\  T_s^{\ast} = g^{t_s^{\ast}} $ \\
 $12.\  c_s = \SE.\Enc(k, len, H, T_s^{\ast}, st_e)$ \\
 $13.\  pms^{\ast} = T_c^{t_s^{\ast}}$ \\
 $14.\  ms^{\ast} = \PRF(pms^{\ast}, \NONC^{\prime})$ \\
 $15.\  trans^{\ast} = T_s^{\ast} \| T_c^{\prime} \| \SCID \| \NONC^{\prime}$ \\
 $16.\  k=\PRF(ms^{\ast}, trans^{\ast})$ \\
 $17.\  m_2^{\prime} = (c_s)$ \\
 $18.\  \Lambda=\accept$ \\
 $19.\  \theta(\SCID) \leftarrow (T_s^{\ast}, t_s^{\ast})$ \\
 $$\\
\end{tabular}
\end{minipage}
}

\caption{Abstract model of our proposed scheme}\label{fig:quic_detail}
\end{center}
\end{figure*}