\begin{figure*}[htb]
\begin{center}

\fbox{
\begin{minipage}[t]{0.39\textwidth}
\begin{tabular}[c]{l}
 $ $ \\
 $ $ \\
 $ $ \\
 $ $ \\
 \setcounter{nombre}{0}%
\ifONERTT
 $\prob.\quad receive\ m_4$ \\
\else
 $\prob.\quad receive\ m_2$ \\
\fi
 $\prob.\quad T_s^{\prime} \| \STK = \SE.\Dec(\ik, c)$ \\
 $\prob.\quad pms^{\prime} = T_s^{\prime t_c} $ \\
 $\prob.\quad ms^{\prime} = \PRF(pms^{\prime}, \NONC) $ \\
\ifONERTT
 $\prob.\quad \key = \PRF(ms^{\prime}, m_1 \| m_2 \| m_3 \| m_4)$ \\
\else
 $\prob.\quad \key = \PRF(ms^{\prime}, m_1 \| m_2)$ \\
\fi
 $\prob.\quad \Lambda = \accept$ \\
 $\prob.\quad \theta = (\SCFG_{pub}, \STK)$ \\
\end{tabular}
\end{minipage}%
}
\begin{minipage}[t]{0.13\textwidth}
\centering
\begin{tabular}[c]{l}
 $ $\\
 $ $\\
 $ $\\
\ifONERTT
 $\xleftarrow{m_4}$\\
\else
 $\xleftarrow{m_2}$\\
\fi
 $ $\\
 $ $\\
 $ $\\
 $ $\\
 $ $\\
\end{tabular}
\end{minipage}%
\fbox{
\begin{minipage}[t]{0.39\textwidth}
\begin{tabular}[c]{l}
 \setcounter{nombre}{0}%
 $\prob.\quad t_s^{\prime} \xleftarrow{\$} \Zset_{q}^{\ast}$ \\
 $\prob.\quad T_s^{\prime} = g^{t_s^{\prime}}$ \\
 $\prob.\quad \makeSTKQUIC$ \\
 $\prob.\quad \plaintext = T_s^{\prime} \| \STK$ \\
 $\prob.\quad c = (\SE.\Enc(\ik, \plaintext)$ \\
\ifONERTT
 $\prob.\quad m_4 = (c, \cid)$ \\
 $\prob.\quad send\ m_4$ \\
\else
 $\prob.\quad m_2 = (c, \cid)$ \\
 $\prob.\quad send\ m_2$ \\
\fi
 $\prob.\quad pms^{\prime} = T_c{t_s^{\prime}} $ \\
 $\prob.\quad ms^{\prime} = \PRF(pms^{\prime}, \NONC) $ \\
\ifONERTT
 $\prob.\quad \key = \PRF(ms^{\prime}, m_1 \| m_2 \| m_3 \| m_4)$ \\
\else
 $\prob.\quad \key = \PRF(ms^{\prime}, m_1 \| m_2)$ \\
\fi
 $\prob.\quad \Lambda = \accept$ \\
\end{tabular}
\end{minipage}%
}

\caption{Abstract model of 1-RTT connection establishment for final key in QUIC handshake}\label{fig:quic_abst_1rtt_last}
\end{center}
\end{figure*}