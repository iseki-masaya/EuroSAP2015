%=====================================================
\section{Introduction} \label{sec:intro}
%=====================================================
Quick UDP Internet Connections (QUIC for short) is a
new transport layer network protocol recently proposed
by Google \cite{QUIC,QUICDraft}, which is experimentally
implemented in Google Chrome.
The main purpose of developing QUIC is to provide an
alternative equivalence of TLS wrapping TCP, with much
reduced latency and better SPDY and HTTP/2 support.
Transport Layer Security (TLS) starts with a three-move
TCP handshake before initiating the TLS Handshake
Protocol.
In contrast, QUIC uses UDP and starts with its own
handshake, which reduces the total number of
interactions.
The cryptographic core of QUIC is specified in the QUIC
crypto protocol~\cite{QUIC:Crypto}, which consists of a
handshake protocol and a record layer protocol, as does
TLS.
Similarly to TLS, QUIC has two types of handshake
connections.
One is called a full handshake -- a handshake
``from scratch" between a client and a server.
The other is called an abbreviate handshake -- a
handshake which occurs when a client and a server have
once established a full handshake session and want to
establish a new session between them in an abbreviate way.
Unlike TLS, QUIC only supports the elliptic-curve
Diffie-Hellman key-exchange (ECDHE) cipher suites and
server authentication.
%
One of the good features of QUIC is that it can
establish an abbreviate session with $0$-RTT
connectivity overhead.
Namely, in the QUIC abbreviate handshake, a client can send
encrypted data to a server, concurrently with a new session.
% We provide the abstract model of the full handshake and
% abbreviate handshake protocols of QUIC in
% Fig.~\ref{fig:quic_abst_1rtt_init},~\ref{fig:quic_abst_1rtt_last}, and ~\ref{fig:quic_abst_0rtt}.
By this property, an abbreviate handshake connection is called
0-RTT connection and a full handshake connection is called
1-RTT connection.

%=====================================================
\subsection{Prior Security Analyzes and Security Concerns} \label{sec:concern}
%=====================================================
To the best of our knowledge, there are only two
security analyzes on QUIC~\cite{FG14:QUIC,LJBN15:QUIC}.
Both papers define the new security models and show that
QUIC is secure in that model.
In~\cite{FG14:QUIC}, they formalized a secure
authenticated key-exchange as an extension of the
Bellare-Rogaway model~\cite{BR93:AKE} and analyzed the
security of QUIC (with abbreviate handshakes).
However, the QUIC protocol analyzed in \cite{FG14:QUIC}
is slightly different from the protocol given in the
source codes.
The QUIC protocol makes a
server send a ciphertext (using authenticated
encryption) in the full handshake session, which cannot
preserve \textit{key-indistinguishability}.
Therefore, the authenticated and channel confidentiality
establishment (ACCE) model~\cite{JKSS12:ACCE} is more
suitable to analyze QUIC.
Another important security issue is that in~\cite{FG14:QUIC},
an adversary is allowed to send a ``test" query only to
a client oracle (to receive either a real session-key or
a random key from the client oracle), when a protocol
is server-only authenticated.
Apparently, the restriction is appropriate, because
an adversary can establish a session with a honest
server (due to the lack of client's certificate) to
share a session key.
However, if an abbreviate handshake is provided, we should consider
the attack that, after a honest client and a honest
server establish a full handshake session, an adversary
might hijack an abbreviate handshake session -- it might
impersonate the initial client and share a session key
with the server.
To prevent the attack, we should allow an adversary to
send test queries to \textit{server} oracles in abbreviate
handshake sessions (including the full handshake session), as long
as the initial full handshake session is established
between a honest client and a honest server.
We can consider an attack: The adversary can
share a session key with the server and it can make the
server accept in an abbreviate handshake session. (Note that in a
full handshake session, it is a ``trivial" attack, because
an adversary can always do so.)
In~\cite{LJBN15:QUIC}, they formalized QACCE model which
is based on ACCE model and consider full handshakes and
abbreviate handshakes.
They also found that with a replay attack on some
public parameters exchanged during the handshake, an
adversary could easily prevent QUIC from achieving
minimal latency advantages either by having it fall back
to TCP or by causing the client and the server to have an
inconsistent view of their handshake leading to a failure
to complete the connection.
The adversary can increase server loads using
these attacks.
Their security model QACCE does not consider these attacks
to prove the security of QUIC as it is.
These attacks are ruled out in their proposed security model.
In QACCE, an adversary
is allowed to send a ``test" query to a server oracle in an
abbreviate handshake.
However, they add a restriction that an adversary is allowed
to send it only the server oracle which has a matching
conversation with a client oracle.
% An adversary needs to forge the query to make a server accept
% and the server does not have a matching conversations with any
% client oracle.
By this restriction, QACCE does not prevent the attack that
an adversary make a server accept.
In QUIC, a server does not make sure consistencies of a client
between 0-RTT connections and 1-RTT connections and
an adversary can establish a connection with the server in 0-RTT connections.
This property allows one of the attacks found in~\cite{LJBN15:QUIC} that
the adversary can establish the connection spoofing IP address.
This assists the adversary to do Distributed Denial of Service
(DDoS) attack.
Our security model guarantees that only parties
that establish the initial full handshake session can
establish a new abbreviate handshake session.
% Our security model also prevent other attacks.
% In QUIC, the client and server share two keys which are an initial
% key $\ik$ and a final key $\key$.
Other attacks~\cite{LJBN15:QUIC} make a client and a server share
a different initial key $\ik$.
The server impersonation advantage in QACCE does not
cover this case because this advantage consider only forward
secure key $\key$.
Our security model also consider the security of an initial
key $\ik$ and it prevents the other attacks
~\cite{LJBN15:QUIC}.

%=====================================================
\subsection{Related Work} \label{sec:Related Work}
%=====================================================
There are a huge body of works on authenticated key
exchange protocols (See~\cite{CK01:AKE} for survey).
An important stream of research dates back to Bellare
and Rogaway~\cite{BR93:AKE}, followed by~\cite{DB96,
Blei98,JMDP00,JB02,EK09,KK05:TLS,KCRE08,SMOAJ08,KTT11,
Kraw01}.
However, as mentioned above, the QUIC full handshake
protocol does not satisfy key-indistinguishability as
in the Bellare-Rogaway like model, because a server
sends a ciphertext (using authenticated encryption) in
the full handshake session, as does TLS.
TLS Handshake Protocol is recently analyzed in various
security models, e.g., ~\cite{JKSS12:ACCE,KPW13:SACCE,
FS13:ACCE,GKS13:RACCE,BDKSS14:SSH,BFKPSB14:TLS}.
Still, the security model for analyzing a server-only
authenticated connection of TLS, i.e., Server-Only
Authenticated and Confidential Channel Establishment
(SACCE)~\cite{KPW13:SACCE}, is not appropriate for QUIC.
There are two reasons. First, the abstract model of
handshake between QUIC and TLS is different. In QUIC,
the client and server share two keys which are an initial
key $\ik$ and a final key $\key$ and secrets are not
reused in an abbreviate handshake. On the other hand,
in TLS, the client and server share one key and reuse
the secrets in an abbreviate handshake. Second, the
security model proposed in the previous study
~\cite{FG14:QUIC,LJBN15:QUIC} does not
consider the consistency of the client between a full
handshake and abbreviate handshakes.
% The second reasons is important in order to prevent the
% attacks \cite{LJBN15:QUIC}.

%=====================================================
\subsection{Our Results} \label{sec:proposal}
%=====================================================

Our contributions are:
\begin{itemize}
 \item{A security model which is appropriate for QUIC
 and more secure than QACCE.}

 \item{A new scheme which is more secure and efficient
 than original QUIC.}
\end{itemize}

We introduce a new
security model, what we call \textit{Resumable} SACCE
(RSACCE) security, where we consider a server's message
confidentiality, as well as a client's message
confidentiality, where an adversary is allowed to send
an encryption query which is similar to ``test" query to a \textit{server} (to break a
server's message confidentiality) both in the full
handshake session and the abbreviate handshake sessions,
as far as the server establishes the initial full
handshake session with a \textit{honest} client.
Our security model also consider the consistency of the client between
0-RTT connections and 1-RTT connections.
The consistency of the client between 0-RTT connections
and 1-RTT connections prevent one of the attacks.

We also propose a new scheme which is more secure and more efficient
than the original QUIC and it satisfy RSACCE secure.
In the our proposed scheme, a client sends its Diffie-Hellman public value in
a first query while in original QUIC the client sends its Diffie-Hellman
public value in a second query.
For this scheme, the server can generate MAC for important parameters in the
response and it prevents the attacks.
% In~\cite{LJBN15:QUIC}, they found the five attacks for
% QUIC and the our proposed scheme can prevent the four attacks.